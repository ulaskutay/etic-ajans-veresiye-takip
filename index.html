<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Etic Ajans - Veresiye Takip S√ºr√ºm: 1.0.1.1</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <div class="company-info" style="display: flex; align-items: center; gap: 15px;">
                    <div id="company-logo" style="width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; background: #f3f4f6; border-radius: 8px; border: 2px solid #e5e7eb;">
                        <span style="font-size: 24px; color: #9ca3af;">üè¢</span>
                    </div>
                    <div>
                        <h1 id="company-name" style="margin: 0; font-size: 20px; color: white; font-weight: 600;">Etic Ajans</h1>
                        <p style="margin: 0; font-size: 12px; color: rgba(255,255,255,0.8);">Veresiye Takip S√ºr√ºm: 1.0.1.1</p>
                    </div>
                </div>
                <div class="keyboard-hints">
                    <span class="hint"><kbd>F1</kbd> M√º≈üteri Ara</span>
                    <span class="hint"><kbd>F4</kbd> Satƒ±≈ü Ekle</span>
                    <span class="hint"><kbd>F5</kbd> Tahsilat Ekle</span>
                </div>
            </div>
            <div class="header-right">
                <button class="header-btn" onclick="showProductManagement()">üìã √úr√ºnler</button>
                <button class="header-btn" onclick="showAlertManagement()">üö® Uyarƒ±lar</button>
                <button class="header-btn" onclick="showReports()">üìä Raporlar</button>
                <button class="header-btn" onclick="showSettings()">‚öôÔ∏è Ayarlar</button>
                <button class="header-btn exit" onclick="exitApp()">‚ùå √áƒ±kƒ±≈ü</button>
            </div>
        </header>

        <!-- Top Controls -->
        <div class="top-controls">
            <div class="date-filters">
                <label>üìÖ Tarih Aralƒ±ƒüƒ±:</label>
                <div class="quick-filters">
                    <button class="quick-filter-btn" onclick="setQuickFilter('today')">Bug√ºn</button>
                    <button class="quick-filter-btn" onclick="setQuickFilter('yesterday')">D√ºn</button>
                    <button class="quick-filter-btn" onclick="setQuickFilter('last7days')">Son 7 G√ºn</button>
                    <button class="quick-filter-btn" onclick="setQuickFilter('last30days')">Son 30 G√ºn</button>
                    <button class="quick-filter-btn" onclick="setQuickFilter('thisMonth')">Bu Ay</button>
                    <button class="quick-filter-btn" onclick="setQuickFilter('lastMonth')">Ge√ßen Ay</button>
                    <button class="quick-filter-btn" onclick="setQuickFilter('all')">T√ºm√º</button>
                </div>
                <div class="custom-date-range">
                    <input type="date" id="start-date" value="2023-05-01">
                    <span>‚Üí</span>
                    <input type="date" id="end-date" value="2023-05-31">
                </div>
            </div>
            <div class="filter-totals" id="filter-totals" style="display: none;">
                <div class="total-item">
                    <span class="total-label">üí∞ Toplam Satƒ±≈ü:</span>
                    <span class="total-value" id="filtered-sales-total">0,00 ‚Ç∫</span>
                </div>
                <div class="total-item">
                    <span class="total-label">üí≥ Toplam Tahsilat:</span>
                    <span class="total-value" id="filtered-payments-total">0,00 ‚Ç∫</span>
                </div>
                <div class="total-item">
                    <span class="total-label">‚öñÔ∏è Net Bakiye:</span>
                    <span class="total-value" id="filtered-net-total">0,00 ‚Ç∫</span>
                </div>
            </div>
            <div class="action-buttons">
                <button class="action-btn primary" onclick="queryTransactions()">üîç ƒ∞≈ülem Sorgula</button>
                <button class="action-btn" onclick="showBalanceTotal()">üìä Bakiye √ñzeti</button>
                <button class="action-btn" onclick="printBalanceReport()">üñ®Ô∏è Yazdƒ±r</button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Left Panel: Cari Hesap Listesi -->
            <div class="left-panel">
                <div class="panel-header">
                    <h2>üìã CARƒ∞ HESAP Lƒ∞STESƒ∞</h2>
                </div>
                
                <!-- Account Summary -->
                <div class="account-summary">
                    <div class="summary-item">
                        <span class="label">Toplam Satƒ±≈ü:</span>
                        <span class="value" id="total-sales">0,00</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Toplam Tahsilat:</span>
                        <span class="value" id="total-payments">0,00</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Toplam Bor√ß:</span>
                        <span class="value" id="total-debt">0,00</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Net Bakiye:</span>
                        <span class="value" id="net-balance">0,00</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Tahsilat Oranƒ±:</span>
                        <span class="value" id="payment-rate">0%</span>
                    </div>
                </div>

                <!-- Account Management Buttons -->
                <div class="account-buttons">
                    <button class="account-btn" onclick="showAddCustomerModal()">Hesap Ekle</button>
                    <button class="account-btn" onclick="showExcelCustomerImportModal()" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">üìä Excel Import</button>
                    <button class="account-btn" onclick="editCustomer()">Hesap Deƒüi≈ütir</button>
                    <button class="account-btn" onclick="deleteCustomer()">Hesap Sil</button>
                </div>

                <!-- Search -->
                <input type="text" class="search-input" id="customer-search" placeholder="M√º≈üteri adƒ± yazƒ±n ve Enter'a basƒ±n.." onkeyup="searchCustomers()" onkeydown="handleCustomerSearchKeydown(event)">

                <!-- Customer List -->
                <div class="customer-list">
                    <table class="customer-table">
                        <thead>
                            <tr>
                                <th>√únvanƒ±/Adƒ±</th>
                                <th>Kodu</th>
                            </tr>
                        </thead>
                        <tbody id="customer-table-body">
                            <!-- Customers will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Middle Panel: ƒ∞≈ülem Listesi -->
            <div class="middle-panel">
                <div class="panel-header">
                    <h2>üìã ƒ∞≈ûLEM Lƒ∞STESƒ∞</h2>
                </div>

                <!-- Selected Customer Info -->
                <div class="selected-customer-info" id="selected-customer-info">
                    <div class="customer-info-container">
                        <div class="customer-details">
                            <div class="customer-name" id="selected-customer-name">DENEME A.≈û.</div>
                            <div class="detail-grid">
                                <div class="detail-row">
                                    <span class="label">Tel:</span>
                                    <span class="value" id="customer-phone">-</span>
                                </div>
                                <div class="detail-row">
                                    <span class="label">Gsm:</span>
                                    <span class="value" id="customer-gsm">-</span>
                                </div>
                                <div class="detail-row">
                                    <span class="label">Limit:</span>
                                    <span class="value" id="customer-limit">500,00</span>
                                </div>
                                <div class="detail-row">
                                    <span class="label">Aktif Hesap:</span>
                                    <span class="value active-account" id="customer-status">Aktif Hesap</span>
                                </div>
                                <div class="detail-row">
                                    <span class="label">Bor√ß:</span>
                                    <span class="value" id="customer-debt">0,00</span>
                                </div>
                                <div class="detail-row">
                                    <span class="label">Tahsilat Toplamƒ±:</span>
                                    <span class="value" id="customer-credit">0,00</span>
                                </div>
                                <div class="detail-row">
                                    <span class="label">Bakiye:</span>
                                    <span class="value" id="customer-balance">0,00</span>
                                </div>
                                <div class="detail-row">
                                    <span class="label">Son Tahsilat Tarihi:</span>
                                    <span class="value" id="last-payment-date">-</span>
                                </div>
                                <div class="detail-row">
                                    <span class="label">Son Satƒ±≈ü Tarihi:</span>
                                    <span class="value" id="last-sale-date">-</span>
                                </div>
                            </div>
                        </div>
                        <div class="customer-action-buttons">
                            <button class="customer-action-btn" onclick="addSale()">üí∞ Satƒ±≈ü Ekle</button>
                            <button class="customer-action-btn" onclick="addPurchase()">üí≥ Tahsilat Ekle</button>
                            <button class="customer-action-btn" onclick="editCustomer()">‚úèÔ∏è M√º≈üteri D√ºzenle</button>
                            <button class="customer-action-btn" onclick="deleteCustomer()">üóëÔ∏è M√º≈üteri Sil</button>
                        </div>
                    </div>
                </div>

                <!-- Transaction Sections (Side by Side) -->
                <div class="transaction-sections">
                    <!-- Sales-Payment Section -->
                    <div class="transaction-section">
                        <div class="section-header">
                            <h3>üìä T√úM ƒ∞≈ûLEMLER</h3>
                            <div class="section-buttons">
                                <button class="section-btn" onclick="addTransaction()">Ekle</button>
                                <button class="section-btn" onclick="editTransaction()">Deƒüi≈ütir</button>
                                <button class="section-btn" onclick="deleteTransaction()">Sil</button>
                            </div>
                        </div>
                        
                        <input type="text" class="search-input" placeholder="Arama i√ßin tƒ±klayƒ±nƒ±z..">
                        
                        <div class="transaction-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>G√ºn</th>
                                        <th>Ay</th>
                                        <th>Yƒ±l</th>
                                        <th>T√ºr</th>
                                        <th>A√ßƒ±klama</th>
                                        <th>Miktar</th>
                                        <th>Tutar</th>
                                        <th>Bakiye</th>
                                    </tr>
                                </thead>
                                <tbody id="sales-table-body">
                                    <tr>
                                        <td colspan="8" class="no-data">&lt;G√∂sterilecek Bilgi Yok&gt;</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Modals -->
    <!-- Edit Sale Modal -->
    <div id="edit-sale-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Satƒ±≈ü D√ºzenle</h2>
                <span class="close" onclick="closeModal('edit-sale-modal')">&times;</span>
            </div>
            <form id="edit-sale-form" onsubmit="handleEditSale(event)">
                <input type="hidden" id="edit-sale-id" name="id">
                    <input type="hidden" id="edit-sale-original-created-at" name="original_created_at">
                
                <div class="form-group">
                    <label for="edit-sale-customer">M√º≈üteri *</label>
                    <input type="text" id="edit-sale-customer" name="customer" required readonly>
                </div>
                
                <div class="form-group">
                    <label for="edit-sale-date">Tarih *</label>
                    <input type="date" id="edit-sale-date" name="date" required>
                </div>
                
                <div class="form-group">
                    <label for="edit-sale-product">√úr√ºn</label>
                    <select id="edit-sale-product" name="product_id" onchange="handleEditProductSelection()">
                        <option value="">√úr√ºn Se√ßin</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="edit-sale-amount">Tutar (KDV Dahil) *</label>
                    <input type="number" id="edit-sale-amount" name="amount" step="0.01" min="0" required>
                    </div>
                
                <div class="form-group">
                    <label for="edit-sale-description">A√ßƒ±klama</label>
                    <input type="text" id="edit-sale-description" name="description" placeholder="Satƒ±≈ü a√ßƒ±klamasƒ±">
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('edit-sale-modal')">ƒ∞ptal</button>
                    <button type="submit" class="btn-primary">G√ºncelle</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Purchase Modal -->
    <div id="edit-purchase-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Tahsilat D√ºzenle</h2>
                <span class="close" onclick="closeModal('edit-purchase-modal')">&times;</span>
            </div>
            <form id="edit-purchase-form" onsubmit="handleEditPurchase(event)">
                <input type="hidden" id="edit-purchase-id" name="id">
                
                <div class="form-group">
                    <label for="edit-purchase-customer">M√º≈üteri *</label>
                    <input type="text" id="edit-purchase-customer" name="customer" required readonly>
                </div>
                
                <div class="form-group">
                    <label for="edit-purchase-date">Tarih *</label>
                    <input type="date" id="edit-purchase-date" name="date" required>
                </div>
                
                <div class="form-group">
                    <label for="edit-purchase-amount">Tutar *</label>
                    <input type="number" id="edit-purchase-amount" name="amount" step="0.01" min="0" required>
                </div>
                
                <div class="form-group">
                    <label for="edit-purchase-description">A√ßƒ±klama</label>
                    <input type="text" id="edit-purchase-description" name="description" placeholder="Tahsilat a√ßƒ±klamasƒ±">
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('edit-purchase-modal')">ƒ∞ptal</button>
                    <button type="submit" class="btn-primary">G√ºncelle</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Add Customer Modal -->
    <div id="add-customer-modal" class="modal">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3>Hesap Ekle</h3>
                <button class="close-btn" onclick="closeModal('add-customer-modal')">&times;</button>
            </div>
            <form id="add-customer-form">
                <!-- Tab Navigation -->
                <div class="tab-navigation">
                    <button type="button" class="tab-btn active" onclick="switchTab('basic-info')">Temel Bilgiler</button>
                    <button type="button" class="tab-btn" onclick="switchTab('tax-info')">Vergi Bilgileri</button>
                    <button type="button" class="tab-btn" onclick="switchTab('invoice-info')">Fatura Bilgileri</button>
                    <button type="button" class="tab-btn" onclick="switchTab('e-invoice-info')">E-Fatura</button>
                </div>

                <!-- Tab Content -->
                <div class="tab-content">
                    <!-- Temel Bilgiler Tab -->
                    <div id="basic-info" class="tab-panel active">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="customer-name">√únvanƒ±/Adƒ± *</label>
                                <input type="text" id="customer-name" required>
                            </div>
                            <div class="form-group">
                                <label for="customer-code">Kodu</label>
                                <input type="text" id="customer-code">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="customer-type">M√º≈üteri Tipi</label>
                                <select id="customer-type">
                                    <option value="individual">Bireysel</option>
                                    <option value="company">Kurumsal</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="customer-limit">Kredi Limiti</label>
                                <input type="number" id="customer-limit-input" step="0.01" value="500">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="customer-phone">Telefon</label>
                                <input type="tel" id="customer-phone-input">
                            </div>
                            <div class="form-group">
                                <label for="customer-gsm">Gsm</label>
                                <input type="tel" id="customer-gsm-input">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="customer-email">E-posta</label>
                            <input type="email" id="customer-email">
                        </div>

                        <div class="form-group">
                            <label for="customer-website">Web Sitesi</label>
                            <input type="url" id="customer-website">
                        </div>

                <div class="form-group">
                    <label for="customer-address">Adres</label>
                    <textarea id="customer-address" rows="3"></textarea>
                        </div>
                    </div>

                    <!-- Vergi Bilgileri Tab -->
                    <div id="tax-info" class="tab-panel">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="customer-tc-number">TC Kimlik No</label>
                                <input type="text" id="customer-tc-number" maxlength="11">
                            </div>
                            <div class="form-group">
                                <label for="customer-tax-number">Vergi Numarasƒ±</label>
                                <input type="text" id="customer-tax-number">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="customer-tax-office">Vergi Dairesi</label>
                            <input type="text" id="customer-tax-office">
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="customer-contact-person">Yetkili Ki≈üi</label>
                                <input type="text" id="customer-contact-person">
                            </div>
                            <div class="form-group">
                                <label for="customer-contact-phone">Yetkili Telefon</label>
                                <input type="tel" id="customer-contact-phone">
                            </div>
                        </div>
                    </div>

                    <!-- Fatura Bilgileri Tab -->
                    <div id="invoice-info" class="tab-panel">
                        <div class="form-group">
                            <label for="customer-invoice-address">Fatura Adresi</label>
                            <textarea id="customer-invoice-address" rows="3"></textarea>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="customer-invoice-city">≈ûehir</label>
                                <input type="text" id="customer-invoice-city">
                            </div>
                            <div class="form-group">
                                <label for="customer-invoice-district">ƒ∞l√ße</label>
                                <input type="text" id="customer-invoice-district">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="customer-invoice-postal-code">Posta Kodu</label>
                                <input type="text" id="customer-invoice-postal-code">
                            </div>
                            <div class="form-group">
                                <label for="customer-account-code">Hesap Kodu</label>
                                <input type="text" id="customer-account-code">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="customer-cost-center">Maliyet Merkezi</label>
                            <input type="text" id="customer-cost-center">
                        </div>
                    </div>

                    <!-- E-Fatura Tab -->
                    <div id="e-invoice-info" class="tab-panel">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="customer-e-invoice-alias">E-Fatura Alias</label>
                                <input type="text" id="customer-e-invoice-alias">
                            </div>
                            <div class="form-group">
                                <label for="customer-e-archive-alias">E-Ar≈üiv Alias</label>
                                <input type="text" id="customer-e-archive-alias">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="customer-e-invoice-enabled">
                                    E-Fatura Aktif
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="customer-e-archive-enabled">
                                    E-Ar≈üiv Aktif
                                </label>
                            </div>
                        </div>

                        <div class="info-box">
                            <h4>üìã E-Fatura Entegrasyonu</h4>
                            <p>E-fatura ve e-ar≈üiv √∂zellikleri gelecek s√ºr√ºmde aktif olacaktƒ±r. ≈ûimdilik bilgileri kaydedebilirsiniz.</p>
                        </div>
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('add-customer-modal')">
                        ƒ∞ptal
                    </button>
                    <button type="submit" class="btn btn-primary">
                        Kaydet
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Customer Modal -->
    <div id="edit-customer-modal" class="modal">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3>Hesap D√ºzenle</h3>
                <button class="close-btn" onclick="closeModal('edit-customer-modal')">&times;</button>
            </div>
            <form id="edit-customer-form">
                <input type="hidden" id="edit-customer-id">
                
                <!-- Tab Navigation -->
                <div class="tab-navigation">
                    <button type="button" class="tab-btn active" onclick="switchTab('edit-basic-info')">Temel Bilgiler</button>
                    <button type="button" class="tab-btn" onclick="switchTab('edit-tax-info')">Vergi Bilgileri</button>
                    <button type="button" class="tab-btn" onclick="switchTab('edit-invoice-info')">Fatura Bilgileri</button>
                    <button type="button" class="tab-btn" onclick="switchTab('edit-e-invoice-info')">E-Fatura</button>
                </div>

                <!-- Tab Content -->
                <div class="tab-content">
                    <!-- Temel Bilgiler Tab -->
                    <div id="edit-basic-info" class="tab-panel active">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="edit-customer-name">√únvanƒ±/Adƒ± *</label>
                                <input type="text" id="edit-customer-name" required>
                            </div>
                            <div class="form-group">
                                <label for="edit-customer-code">Kodu</label>
                                <input type="text" id="edit-customer-code">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="edit-customer-type">M√º≈üteri Tipi</label>
                                <select id="edit-customer-type">
                                    <option value="individual">Bireysel</option>
                                    <option value="company">Kurumsal</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="edit-customer-limit">Kredi Limiti</label>
                                <input type="number" id="edit-customer-limit" step="0.01">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="edit-customer-phone">Telefon</label>
                                <input type="tel" id="edit-customer-phone">
                            </div>
                            <div class="form-group">
                                <label for="edit-customer-gsm">Gsm</label>
                                <input type="tel" id="edit-customer-gsm">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="edit-customer-email">E-posta</label>
                            <input type="email" id="edit-customer-email">
                        </div>

                        <div class="form-group">
                            <label for="edit-customer-website">Web Sitesi</label>
                            <input type="url" id="edit-customer-website">
                        </div>

                        <div class="form-group">
                            <label for="edit-customer-address">Adres</label>
                            <textarea id="edit-customer-address" rows="3"></textarea>
                        </div>
                    </div>

                    <!-- Vergi Bilgileri Tab -->
                    <div id="edit-tax-info" class="tab-panel">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="edit-customer-tc-number">TC Kimlik No</label>
                                <input type="text" id="edit-customer-tc-number" maxlength="11">
                            </div>
                            <div class="form-group">
                                <label for="edit-customer-tax-number">Vergi Numarasƒ±</label>
                                <input type="text" id="edit-customer-tax-number">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="edit-customer-tax-office">Vergi Dairesi</label>
                            <input type="text" id="edit-customer-tax-office">
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="edit-customer-contact-person">Yetkili Ki≈üi</label>
                                <input type="text" id="edit-customer-contact-person">
                            </div>
                            <div class="form-group">
                                <label for="edit-customer-contact-phone">Yetkili Telefon</label>
                                <input type="tel" id="edit-customer-contact-phone">
                            </div>
                        </div>
                    </div>

                    <!-- Fatura Bilgileri Tab -->
                    <div id="edit-invoice-info" class="tab-panel">
                        <div class="form-group">
                            <label for="edit-customer-invoice-address">Fatura Adresi</label>
                            <textarea id="edit-customer-invoice-address" rows="3"></textarea>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="edit-customer-invoice-city">≈ûehir</label>
                                <input type="text" id="edit-customer-invoice-city">
                            </div>
                            <div class="form-group">
                                <label for="edit-customer-invoice-district">ƒ∞l√ße</label>
                                <input type="text" id="edit-customer-invoice-district">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="edit-customer-invoice-postal-code">Posta Kodu</label>
                                <input type="text" id="edit-customer-invoice-postal-code">
                            </div>
                            <div class="form-group">
                                <label for="edit-customer-account-code">Hesap Kodu</label>
                                <input type="text" id="edit-customer-account-code">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="edit-customer-cost-center">Maliyet Merkezi</label>
                            <input type="text" id="edit-customer-cost-center">
                        </div>
                    </div>

                    <!-- E-Fatura Tab -->
                    <div id="edit-e-invoice-info" class="tab-panel">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="edit-customer-e-invoice-alias">E-Fatura Alias</label>
                                <input type="text" id="edit-customer-e-invoice-alias">
                            </div>
                            <div class="form-group">
                                <label for="edit-customer-e-archive-alias">E-Ar≈üiv Alias</label>
                                <input type="text" id="edit-customer-e-archive-alias">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="edit-customer-e-invoice-enabled">
                                    E-Fatura Aktif
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="edit-customer-e-archive-enabled">
                                    E-Ar≈üiv Aktif
                                </label>
                            </div>
                        </div>

                        <div class="info-box">
                            <h4>üìã E-Fatura Entegrasyonu</h4>
                            <p>E-fatura ve e-ar≈üiv √∂zellikleri gelecek s√ºr√ºmde aktif olacaktƒ±r. ≈ûimdilik bilgileri kaydedebilirsiniz.</p>
                        </div>
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('edit-customer-modal')">
                        ƒ∞ptal
            </button>
                    <button type="submit" class="btn btn-primary">
                        G√ºncelle
            </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Sale Modal -->
    <div id="add-sale-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Satƒ±≈ü Ekle</h3>
                <button class="close-btn" onclick="closeModal('add-sale-modal')">&times;</button>
            </div>
            <form id="add-sale-form">
                <div class="form-group">
                    <label for="sale-customer">M√º≈üteri *</label>
                    <input type="text" id="sale-customer" placeholder="M√º≈üteri se√ßildi..." readonly>
                </div>
                
                <!-- TUTAR - EN √ñNEMLƒ∞ ALAN, ƒ∞LK SIRADA -->
                <div class="form-group">
                    <label for="sale-amount">Tutar (KDV Dahil) *</label>
                    <input type="number" id="sale-amount" step="0.01" placeholder="Tutarƒ± girin ve Enter'a basƒ±n" required autofocus>
                </div>
                
                <div class="form-group">
                    <label for="sale-date">Tarih *</label>
                    <input type="date" id="sale-date" required>
                </div>
                
                <div class="form-group">
                    <label for="sale-description">A√ßƒ±klama</label>
                    <input type="text" id="sale-description" placeholder="Opsiyonel a√ßƒ±klama">
                </div>
                
                <!-- √úR√úN SE√áƒ∞Mƒ∞ - OPSIYONEL, ALTTA -->
                <div class="form-group" style="border-top: 1px solid #e0e0e0; padding-top: 15px; margin-top: 10px;">
                    <label for="sale-product" style="color: #999;">√úr√ºn Se√ß (Opsiyonel)</label>
                    <div style="display: flex; gap: 8px;">
                        <select id="sale-product" style="flex: 1;">
                            <option value="">√úr√ºn se√ßmek i√ßin tƒ±klayƒ±n...</option>
                        </select>
                        <button type="button" class="btn btn-secondary" onclick="showProductModalFromSale()" style="white-space: nowrap;">
                            + √úr√ºn Ekle
                        </button>
                    </div>
                    <small style="color: #999; font-size: 12px;">Not: √úr√ºn se√ßerseniz tutar otomatik g√ºncellenir</small>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('add-sale-modal')">
                        ƒ∞ptal
                    </button>
                    <button type="submit" class="btn btn-primary">
                        üíæ Kaydet (Enter)
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Purchase Modal -->
    <div id="add-purchase-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Tahsilat Ekle</h3>
                <button class="close-btn" onclick="closeModal('add-purchase-modal')">&times;</button>
            </div>
            <form id="add-purchase-form">
                <div class="form-group">
                    <label for="purchase-customer">M√º≈üteri *</label>
                    <input type="text" id="purchase-customer" placeholder="M√º≈üteri se√ßildi..." readonly>
                </div>
                
                <!-- TUTAR - EN √ñNEMLƒ∞ ALAN, ƒ∞LK SIRADA -->
                <div class="form-group">
                    <label for="purchase-amount">Tutar *</label>
                    <input type="number" id="purchase-amount" step="0.01" placeholder="Tutarƒ± girin ve Enter'a basƒ±n" required autofocus>
                </div>
                
                <div class="form-group">
                    <label for="purchase-date">Tarih *</label>
                    <input type="date" id="purchase-date" required>
                </div>
                
            <div class="form-group">
                    <label for="purchase-description">A√ßƒ±klama</label>
                    <input type="text" id="purchase-description" placeholder="Opsiyonel a√ßƒ±klama">
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('add-purchase-modal')">
                        ƒ∞ptal
                    </button>
                    <button type="submit" class="btn btn-primary">
                        üíæ Kaydet (Enter)
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Product Management Modal -->
    <div id="product-management-modal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>√úr√ºn Y√∂netimi</h3>
                <button class="close-btn" onclick="closeModal('product-management-modal')">&times;</button>
            </div>
            <div style="padding: 16px;">
                <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                    <button class="btn btn-primary" onclick="showAddProductModal()">√úr√ºn Ekle</button>
                    <button class="btn btn-secondary" onclick="loadProducts()">Yenile</button>
                </div>
                <div class="product-list">
                    <table class="customer-table" style="width: 100%;">
                        <thead>
                            <tr>
                                <th>√úr√ºn Adƒ±</th>
                                <th>Kod</th>
                                <th>Birim</th>
                                <th>Satƒ±≈ü Fiyatƒ±</th>
                                <th>Stok</th>
                                <th>ƒ∞≈ülemler</th>
                            </tr>
                        </thead>
                        <tbody id="product-table-body">
                            <!-- Products will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Eski Add Product Modal kaldƒ±rƒ±ldƒ± - artƒ±k product-module.js'de dinamik olu≈üturuluyor -->

    <!-- Eski Quick Add Product Modal kaldƒ±rƒ±ldƒ± - artƒ±k yeni √ºr√ºn ekleme modalƒ± kullanƒ±lƒ±yor -->

    <!-- Customer Search Modal -->
    <div id="customer-search-modal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2>üîç M√º≈üteri Arama ve Se√ßim</h2>
                <button class="close-btn" onclick="closeModal('customer-search-modal')">&times;</button>
            </div>
            <div style="padding: 20px;">
                <!-- Arama Kutusu -->
                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="customer-search-input" style="font-weight: 600; color: #4a5568; margin-bottom: 8px; display: block;">
                        üîç M√º≈üteri Ara:
                    </label>
                    <input type="text" id="customer-search-input" placeholder="M√º≈üteri adƒ±, kodu veya telefon numarasƒ± yazƒ±n..." 
                           style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 6px; font-size: 14px;"
                           onkeyup="searchCustomersInModal()" onkeydown="handleCustomerSearchModalKeydown(event)">
                </div>

                <!-- Hƒ±zlƒ± Filtreler -->
                <div style="margin-bottom: 20px;">
                    <h3 style="color: #4a5568; margin-bottom: 10px; font-size: 14px;">‚ö° Hƒ±zlƒ± Filtreler</h3>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                        <button class="btn btn-secondary" onclick="filterCustomersByType('all')" id="filter-all">
                            üìã T√ºm√º
                        </button>
                        <button class="btn btn-secondary" onclick="filterCustomersByType('debt')" id="filter-debt">
                            üí≥ Bor√ßlu M√º≈üteriler
                        </button>
                        <button class="btn btn-secondary" onclick="filterCustomersByType('credit')" id="filter-credit">
                            üí∞ Alacaklƒ± M√º≈üteriler
                        </button>
                        <button class="btn btn-secondary" onclick="filterCustomersByType('zero')" id="filter-zero">
                            ‚öñÔ∏è Sƒ±fƒ±r Bakiye
                        </button>
                    </div>
                </div>

                <!-- M√º≈üteri Listesi -->
                <div style="max-height: 400px; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: 6px;">
                    <div id="customer-search-results">
                        <!-- M√º≈üteriler buraya y√ºklenecek -->
                    </div>
                </div>

                <!-- Alt Bilgiler -->
                <div style="margin-top: 15px; padding: 12px; background: #f7fafc; border-radius: 6px; font-size: 12px; color: #4a5568;">
                    <strong>üí° ƒ∞pucu:</strong> Enter tu≈üu ile se√ßim yapabilir, Escape tu≈üu ile kapatabilirsiniz.
                </div>

                <!-- Alt Butonlar -->
                <div style="margin-top: 20px; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <button class="btn btn-secondary" onclick="showAddCustomerModalFromSearch()">
                            ‚ûï Yeni M√º≈üteri Ekle
                        </button>
                    </div>
                    <div>
                        <button class="btn btn-secondary" onclick="closeModal('customer-search-modal')">
                            ‚ùå Kapat
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <script src="excel-import-export.js"></script>
    <script src="product-module.js"></script>
    <script src="alert-system.js"></script>
    <script src="renderer.js"></script>
    
    <script>
        // Uygulama ba≈ülangƒ±cƒ±nda kullanƒ±cƒ± session'ƒ±nƒ± kontrol et
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üöÄ Uygulama ba≈ülatƒ±lƒ±yor...');
            
            // Kullanƒ±cƒ± session'ƒ±nƒ± ba≈ülat
            const isLoggedIn = await initializeUserSession();
            
            if (isLoggedIn) {
                console.log('‚úÖ Kullanƒ±cƒ± giri≈ü yapmƒ±≈ü, uygulama y√ºkleniyor...');
                // Uygulama verilerini y√ºkle
                await loadCustomers();
                // √úr√ºn mod√ºl√º fonksiyon adlarƒ± deƒüi≈üti
                if (typeof loadProductsData === 'function') await loadProductsData();
                if (typeof loadCategoriesData === 'function') await loadCategoriesData();
                if (typeof loadBrandsData === 'function') await loadBrandsData();
                if (typeof loadAlerts === 'function') await loadAlerts();
                if (typeof loadAlertTriggers === 'function') await loadAlertTriggers();
                
                // Tarih filtrelerini ayarla
                if (typeof setDefaultDates === 'function') setDefaultDates();
                
                console.log('‚úÖ Uygulama ba≈üarƒ±yla y√ºklendi');
            } else {
                console.log('üîê Kullanƒ±cƒ± giri≈üi bekleniyor...');
            }
        });
    </script>